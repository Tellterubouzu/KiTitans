[34m[1mwandb[0m: [33mWARNING[0m Calling wandb.run.save without any arguments is deprecated.Changes to attributes are automatically persisted.
Found 82 files for patterns: ['/mnt/shimo/Pretrain_corpus/en_wiki/train_*.jsonl.gz', '/mnt/shimo/Pretrain_corpus/ja_wiki/train_*.jsonl.gz', '/mnt/shimo/Pretrain_corpus/level0/CC-MAIN-2013-2016.jsonl.gz']
Found 1 files for patterns: ['/mnt/shimo/Pretrain_corpus/en_wiki/validation_0.jsonl.gz']
Found 1 files for patterns: ['/mnt/shimo/Pretrain_corpus/ja_wiki/validation_0.jsonl.gz']
ÊúÄÂàù„ÅÆ10‰ª∂„ÅÆ„Éá„Éº„Çø:
„Éá„Éº„Çø 1: tensor([98292,   301,   285,  2753,   286, 42136,  1818,   273, 14245,   432,
          273,  1095,  1338,   272,   504,  3903,   337,   336,   271,   292,
          303,   298,   340,   276,   271,   279,   274,   274,   274, 28259,
          272,   504,   730, 56697,   909,   726,   429,   281,   271, 98292,
          301,  2675,   286,   276,  2753,   272,    25,    25, 49364,   421,
           25,   356,  1429,   283,   276,  1095,  1338, 30351, 14015,   273,
          276,  2753,   367,   285,  1613,  1038,   281,   271,   289,   292,
          272,   303,  3538, 16831,  4235,   310,   298,   279,   272,   289,
         3538,  2796,   484,   281,   394,   273,   271,   289,   292,   272,
          299,  3538, 16831,  3538, 20168,   280,   310,   298,   279,   272,
          289,  3538,  2796,   293,   281,   325,   301,  2386,   282,   271,
          274,   272,   274,   289,   427,   301,   954,   272,    25,    25,
        24739,  5448,    25,   672,   281,   276, 28259,   281,   271,   279,
          274,   274,   274,   273,   451,   422,   271,   292,   303,   298,
          495,   273,   271,   279,   277,   299,  1321, 16920,   273,   282,
          271,   277,   299,   300,   271,  3119,   271, 54100,   286,   276,
         2753,   272,   504,  3903,   337,  9702,   336,   271,   277,   299,
          272,   279,   495,   799,  6320, 15713,   310,   299,   272,   289,
          296,  2796,   475,   271,   700,   422,   271,   279,   292,   274,
         5994,  5457,   340,   353,  2335,  9702,   281,   271,   303,   272,
          274,   799,  6320, 15713,   310,   279,   272,   303,   296,  2796,
          475,   504, 17096, 23987,   281,   276,  2753,   336,   271,   298,
          298,   272,   289,   277,   427,  2998,   273,   271,   274,   272,
          289,   292,   427, 16139,   271,   840,   273,   282,   271,   274,
          272,   289,   292,   427,   342,   520,   348,   395, 16548,   272,
          271, 27962,   348, 33259,   281,   502,  3261,   422,   271,   274,
          272,   277,   303,   427,   281,   276,  3903,   337,   272,    25,
           25,   700,   422,   271,   279,   277,   299,  1321, 16920,   273,
          411,   281,   394,   271,   289,   289,   272,   289,   427,   437,
          271,   945,   512,   276,  1815,   281,   271,   277,   300,  1939,
          318,   497,   273,   271,   303,   277,   272,   289,   427,   422,
         5957, 22829,  1939,   271,  1116,   273,   271,   279,   272,   300,
          427,   437,   285,  5481,  1321,  5719,   318,   498,  4789,   892,
          273,   282,   271,   279,   277,   272,   300,   427,   422,   980,
          284,  3119,   272,   271,   277,   300,   272,   277,   427,   281,
          384,  1321, 16920,   422,   646,   423,   281,   286,  1110,   280,
          273,   282,   271,   300,   272,   300,   427,   437,  1899,  1939,
         3909,   417,   336,   271,   299,   292,   560,   281,  1815,   348,
         4971,   272,   504,  2335,  1321,  6181,  1532,   336,   271,   279,
          272,   299,   300,   282,   276,  2335,   877,  1532,   336,   271,
          289,   272,   274,   292,   272,    25,    25,   401,   276,  2753,
          273,   276,  3903,   337,   336,  4077,   411,   273,   318,   271,
          279,   292,   272,   298,   427,   512,   276,  1815,   281,   271,
          277,   300,   273,   271,   299,   272,   279,   427,   342,   271,
          277,   300,   283,   271,   279,   294,   273,   271,   279,   294,
          272,   298,   427,   342,   271,   279,   292,   283,   271,   294,
          294,   273,   271,   279,   299,   272,   300,   427,   342,   271,
          294,   292,   283,   271,   299,   294,   273,   282,   271,   277,
          299,   272,   279,   427,   417,   422,   271,   299,   292,   560,
          281,  1815,   348,  4971,   272,   504, 20037,  1815,   336,   271,
          294,   279,   560,   272,  2127,   763,   271,   277,   274,   274,
        30536,   273,   451,   422,   271,   277,   277,   289,   272,   303,
        27784,   272,  2127,   763,   271,   277,   274,   274, 30536,  1815,
          271,   277,   300,   282,   481,   273,   451,   422,   271,   277,
          274,   298,   272,   289, 27784,   272,    25,    25,   323, 20037,
         3920,   305,   285,  1321,  6181,   286,   276,  2753,   336,   386,
          289,   303,   273,   274,   300,   289,   273,   282,   276, 20037,
         3920,   305,   285,   877,   336,   386,   294,   289,   273,   289,
          289,   289,   272, 37553,   280,   437,   285, 20037,  3920,   281,
          386,   289,   274,   273,   277,   292,   299, 13278,   386,   279,
          274,   273,   292,   299,   300,   305, 30536,   272,   504,   799,
        48118,  3920,   305,   276,  2753,   336,   386,   277,   299,   273,
          277,   292,   300,   272,  7865,   271,   294,   272,   277,   427,
          281,   271,  3119,   282,   271,   294,   272,   299,   427,   281,
          276,  3903,   337,   422,  1560,   276, 12534,  1005,   273,   286,
          752,   271,   299,   272,   289,   427,   281,   645,   512,  1815,
          271,   277,   300,   282,  4332,   281,   645,  1815,   271,   299,
          292,   348,   481,   272,    25])
„Éá„Éº„Çø 2: tensor([  617,   360,   522,  ..., 19096,  2700,    25])
„Éá„Éº„Çø 3: tensor([ 3436,   981,   782,   334, 12243, 22448,   905,  1293,  6347,  2425,
          304,   281, 15809,   284, 24717, 51094,   281, 45974, 73086, 34362,
          273,  6728,   318,   285,  6563,   273, 58309, 16439,  1514,   304,
          271, 11499, 34002,   675,   351, 35769,   281, 12243, 22448,   905,
        29017,   272,   271,   736,  1341,   286,  1532,   342,   271,   272,
          806,   271, 46897,  7755,   273,   392,   334,   271, 12013,  1283,
          326,   363,   981,   782,  7083, 85442,  3563,   310,   387, 16838,
        48039,   363,   981,   782,   475,    25,    25,   519,  2353,   381,
          779,    25,   401,  2313,   273,   363,   981,   782,   301,  2771,
          271,   643,   326,   285,   271, 20309,   273,   385,   286,  7529,
          273,   325,   301, 86042,  2568, 24228,   322,   276,  6511,  7500,
          271, 20309,   301,   363,   398, 11727,   273,   285,  1379,  1681,
          610,  1285,  3142,   271,   288, 34233, 15809,   550,   342,   363,
         1913,   273,   271,   288,  5090,   347,   288,   348,   271,   288,
        61826,   288,   272,  2242,  1057,   301,   271, 44322,   286,  2313,
          272,    25,    25, 12262,    25,  1793,  1417,   388, 39537,   784,
          276, 27512,   281,   363,   981,   782,   286,   271,   300,   279,
          303,   842,   277,   274,   298,   277,   271,   286, 14719, 11047,
        22159,  2312,   286, 82882,   273,   339,   276,   719, 43902,  8605,
          281, 31811,   280,  1300,   283,  7078,   390,   285,  2964,   272,
         2242,  1644, 11786,   276, 12641,  4050,   281,   276,  6673,   273,
         1283,   581,   326,   276,   628,  3523,  2656,   281, 82882,   273,
         3185,  5198,   283,   276,  4901,   307,   276,  1436, 20885,   779,
        19966, 13286,   342,   276, 30633,  2369, 12631,  4479,   669, 16699,
          324,  3142,   271,   288, 61826,   280,   288,   286,   452,  1082,
          283,   390, 15809,   284, 24717, 51094,   272,   271,  3406,   344,
          424,   273,   276, 62812,   286, 16669, 12243, 22448,   905, 24888,
          318,   276,   271,  5235,   346,   281,   363,  3246,   309, 23365,
          273,   538,   889, 38186,  1273,   273,   282,   271, 58149,   272,
          271,   736,   416,   286,  5395,   276,   885,  4659,   281,  7947,
          304, 29918,   282, 23365,   318,  8947,   282, 24703,   272,    25,
           25, 16539,  5452,   981, 28301,  6258,  4398,   307,   363,   981,
          782,   870,   342,   276, 24633,   360,  3702,   282, 58126,  1913,
         1854,   282,   422,   271,  5525,   600,   271,  5382,   326,   285,
         1360,   773,   271, 55296,  1232,   273,   271,  6731,   326,   285,
        40284,   429,  9174,   272,   504, 35867,   606,  5690,  2119,   285,
          588,   284, 10949, 35769,   286, 19521,   272,    25,    25,  1793,
         1643,   271, 89280,   286,  5892, 10750,  2027,   337,  1040,   338,
        19741, 50977,   456,   288,   280, 20634,   494,   394,   334,  6728,
          318, 29918,   273,   282, 12631,  4479,   669, 16699,   324,   273,
         3605,   284, 46026, 34362, 43781,  6728,   318,  1711,  6563,   280,
          273,   394,   422,   285,  2076, 73086,   272,    25,    25,   323,
         6059,  1491,  1379, 53770,   288,   356, 57242,   348,  6059,  3563,
         1379, 50633,   382,   273, 10656,   284, 29353,  1757, 68152,   318,
          271,  1164,   304,   282,  8878,   273,   334, 20965,   448,   285,
         9110,   286, 18896,   281,  1257,   271, 97042,   272, 19095,  3246,
          807, 74734,   363, 22448, 25013,   382,   271,   565, 79996,   491,
          288,   280, 47632,   960,   334,  1643, 10656,   282,   285, 93425,
        24936,   284, 29353, 53559, 10953,   272,    25,    25, 11055,   271,
        89280,   271,    25, 14909,   421, 20106,   280,    25, 37766, 41564,
           25,   271, 15390, 86249,    25, 81772, 15967, 61188,   273,   416,
         1283,   326, 37092,   456, 16286,  4221,   286,  4830,   282,   310,
         1002,   378, 61410,   293, 62157,   456, 51404,  7198,   286, 25850,
           25, 16055,  5622,  1909, 35867,    25])
„Éá„Éº„Çø 4: tensor([ 5393, 55861,  1357,  ...,   280,   273,   520])
„Éá„Éº„Çø 5: tensor([14488, 11736,   310,  ...,   765,   715,  2427])
„Éá„Éº„Çø 6: tensor([40680,  1818,   301,  ...,   310,   274,   272])
„Éá„Éº„Çø 7: tensor([ 1172, 13206,  2427,  ...,   289,   274,  1971])
„Éá„Éº„Çø 8: tensor([  356,  9094,   301,  ...,   326, 10470,   280])
„Éá„Éº„Çø 9: tensor([  323,   271,   277,   274,   277,   274,   280,   336,   285,  7448,
          281,   276, 34073,   271, 15252,   394,  2304,   319,  1497,   271,
          277,   273,   271,   277,   274,   277,   274,   273,   282,  5397,
          319,   271,  1548,   271,   289,   277,   273,   271,   277,   274,
          277,   298,   272,    25,    25, 10606,  2227,   495,    25, 25725,
          271,   378,   284,   712,   351,  5685,   271,   378,   284, 19741,
         4773, 45095,   310,   356, 27834, 14841,   654,   293,    25, 25725,
        33144,   468,  2418, 18027,    25, 25725, 11526,  5641,   271,   378,
          284, 10773,  3049,   382,    25,  2408,  3495, 22225,   310,   354,
        12706,   271,   378,   284, 40287, 59978,   293,    25,   419, 24507,
        25832,   310,   354, 12706,   500,  3853,   293,    25,  5667, 15880,
         3279,    25, 28263,   361, 27808,   280,   335,    25,  3991, 12779,
           25, 39834, 51634,   498, 33948,   432, 16301,    25,  8937,  3279,
          273, 11508,  8584, 31407,    25, 47691,  3279,   281,   271,  9453,
           25,  2408,   284,   712,   351,  3180,   564, 12540,  6447,   281,
        17052,   515, 24090,    25, 19996, 76175,   335,    25])
„Éá„Éº„Çø 10: tensor([46974,   630,  7192,  ...,   273,   286,   344])
/mnt/shimo/KiTitans/Pretrain/train_mac_single_A100.py:256: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
/mnt/shimo/KiTitans/Pretrain/train_mac_single_A100.py:268: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/mnt/shimo/KiTitans/Pretrain/titans_pytorch/neural_memory.py:965: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
Using /home/shimomura/.cache/torch_extensions/py311_cu126 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/shimomura/.cache/torch_extensions/py311_cu126/warpscan/build.ninja...
Building extension module warpscan...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
Loading extension module warpscan...
/mnt/shimo/KiTitans/Pretrain/titans_pytorch/neural_memory.py:965: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
/mnt/shimo/KiTitans/Pretrain/train_mac_single_A100.py:268: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch 0 Step 100: Loss = nan
Traceback (most recent call last):
  File "/mnt/shimo/KiTitans/Pretrain/train_mac_single_A100.py", line 272, in <module>
    scaler.scale(loss).backward()
  File "/home/shimomura/Devenv/env/lib/python3.11/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/shimomura/Devenv/env/lib/python3.11/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/shimomura/Devenv/env/lib/python3.11/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
